<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>抢购商品</title>
<style>
body, ul, ol, p, h3, input {
	padding:0;
	margin:0;
	font-size:12px;
}
li {
	list-style:none;
}
b, em {
	font-style:normal;
}
img {
	border:none;
}
.box {
	padding:10px;
	width:648px;
	margin:30px auto;
	border:1px solid #ccc;
}
.h3s {
	height:28px;
	line-height:28px;
	border-bottom:2px solid #9e9e9e;
	color:#6e6e6e;
	font-size:14px;
}
.h3s span {
	padding-left:20px;
	font-size:14px;
	font-weight:normal;
}
.con {
	width:648px;
	height:280px;
	overflow:hidden;
	position:relative;
	background:url(img/none.jpg) 0 0 repeat no-repeat;
}
.none {
	width:325px;
	height:280px;
	position:absolute;
	left:0;
	top:0;
	
	display:none;
	z-index:10;
}
.box ul {
	height:280px;
}
.box ul li {
	width:162px;
	height:280px;
	float:left;
	position:relative;
	left: 0;
	top: 0;
}
.goods {
	width:151px;
	height:264px;
	border-right:2px solid #f2f2f2;
	padding:5px 0 10px 9px;
	position:absolute;
	left:0;
	top:0;
	background-color: white;
}
.dinput {
	width:151px;
	height:21px;
	margin-bottom:15px;
}
.txt {
	width:110px;
	height:19px;
	line-height:19px;
	background-color:#dadada;
	border:1px solid #f2f2f2;
	color:#323232;
	float:left;
}
.btn {
	float:left;
	cursor:pointer;
}
.remtime {
	width:143px;
	padding-left:8px;
	height:16px;
	line-height:16px;
	overflow:hidden;
	margin-bottom:14px;
	color:black;
	display:block;
	font-weight: bold;
}
.dimg {
	width:120px;
	height:117px;
	padding:18px 10px 14px 10px;
	position:relative;
}
.dimg b {
	position:absolute;
	width:48px;
	height:36px;
	padding-top:12px;
	right:0;
	top:0;
	background:url(img/b.png) 0 0 no-repeat;
	text-align:center;
	color:#fff;
}
.dimg b span {
	font-size:20px;
	display:block;
	height:20px;
}
.dps {
	width:145px;
	height:32px;
	line-height:16px;
	color:#6e6e6e;
	overflow:hidden;
}
.price {
	width:145px;
	height:16px;
	line-height:16px;
	color:#c0c0c0;
}
.price em {
	font-style:normal;
	color:#b9003d;
}
.detail {
	width:648px;
	height:36px;
	margin-bottom:3px;
	background-color:#e6e6e6;
}
.detail p, .detail span {
	float:left;
	width:180px;
	text-align:center;
	overflow:hidden;
	color:#323232;
	font-weight:bold;
	line-height:36px;
}
.box ol {
	width:648px;
}
.box ol li {
	width:603px;
	height:62px;
	background-color:#e6e6e6;
	padding:10px 45px 10px 0;
	margin-bottom:3px;
}
.box ol li p, .box ol li span {
	float:left;
	width:170px;
	text-align:center;
	overflow:hidden;
	color:#323232;
	height:62px;
	line-height:62px;
	padding:0 5px;
}
.box ol li span {
	font-weight:bold;
}
.box ol li div {
	width:77px;
	height:60px;
	background-color:#fff;
	border:1px solid #626262;
	float:right;
}
.box ol li div img {
	display:block;
	width:77px;
	height:60px;
}
.result {
	height:44px;
	line-height:44px;
	padding-left:10px;
	color:#000;
	font-size:14px;
	font-weight:bold;
  position:relative;
}
.result strong {
	color:#b9003d;
}
.result input {
  position: absolute;
  right: 10px;
  top: 10px;
 }
 
 #test { width: 200px; height: 200px; background: red; /*opacity: 1;*/}
</style>
</head>

<body>
<div class="box" id="box">
  <h3 class="h3s">限购时间<span>(输入格式为：may,31,2017 14:55:00)</span></h3>
  <div class="con">
    <div class="none" id="none"></div>
    <ul>
      <li>
        <div class="goods">
          <div class="dinput">
            <input type="text" class="txt" value="may,31,2017 14:55:00" />
            <input type="button" class="btn" value="确定" />
          </div>
          <span class="remtime">剩余00天00小时00分00秒</span>
          <div class="dimg"> <img src="img/txd.jpg" width="120" height="117" alt="" /> <b><span>8.8</span>折</b> </div>
          <p class="dps">飞利浦（Philips）RQ370 锐锋系列电动剃须刀</p>
          <p class="price">抢购价：<em>￥</em><em>455.00</em></p>
        </div>
      </li>

      <li>
        <div class="goods">
          <div class="dinput">
            <input type="text" class="txt" value="may,31,2017 14:55:00" />
            <input type="button" class="btn" value="确定" />
          </div>
          <span class="remtime">剩余00天00小时00分00秒</span>
          <div class="dimg"> <img src="img/dn.jpg" width="120" height="117" alt="" /> <b><span>8.8</span>折</b> </div>
          <p class="dps">索尼（SONY） SVF15A18SCB 15.5英寸触控笔记本 </p>
          <p class="price">抢购价：<em>￥</em><em>5599.00</em></p>
        </div>
      </li>
      <li>
        <div class="goods">
          <div class="dinput">
            <input type="text" class="txt" value="may,31,2017 14:55:00" />
            <input type="button" class="btn" value="确定" />
          </div>
          <span class="remtime">剩余00天00小时00分00秒</span>
          <div class="dimg"> <img src="img/sj.jpg" width="120" height="117" alt="" /> <b><span>8.8</span>折</b> </div>
          <p class="dps">联想VIBE Z K910（铂雅银） WCDMA/GSM　双卡双待双通</p>
          <p class="price">抢购价：<em>￥</em><em>2299.00</em></p>
        </div>
      </li>
      <li>
        <div class="goods">
          <div class="dinput">
            <input type="text" class="txt" value="may,31,2017 14:55:00" />
            <input type="button" class="btn" value="确定" />
          </div>
          <span class="remtime">剩余00天00小时00分00秒</span>
          <div class="dimg"> <img src="img/watch.jpg" width="120" height="117" alt="" /> <b><span>8.8</span>折</b> </div>
          <p class="dps">BURBERRY/巴宝莉 时尚英伦格纹优雅石英中性</p>
          <p class="price">抢购价：<em>￥</em><em>899.00</em></p>
        </div>
      </li>
    </ul>
  </div>
  <div class="detail">
    <p>商品名称</p>
    <span>价钱</span>
  </div>
    <ol>
       <!-- <li><p>BURBERRY/巴宝莉 时尚英伦格纹优雅石英中性</p><span>899.00</span><div><img src="img/watch.jpg" width="77" height="60" alt="" /></div></li> --> 
    </ol>
  <div class="result" id="result">
    总价：<strong>0.00</strong>元
  </div>
</div>
</body>
</html>
<script src="Mtween.js"></script>
<script type="text/javascript">
	var lis = document.getElementsByTagName('ul')[0].getElementsByTagName('li');
	var sum = 0;
	var ol = document.getElementsByTagName('ol')[0];
	var result = document.getElementById('result').getElementsByTagName('strong')[0];
	for(var i=0;i<lis.length;i++){
		fn(i);
	}
	//功能相同，结构相似，写好一个，封函数改成传参形式
	function fn(n){
		var goods = lis[n].getElementsByClassName('goods')[0];
		var txt = goods.getElementsByClassName('txt')[0];
		var btn = goods.getElementsByClassName('btn')[0];
		var remtime = goods.getElementsByClassName('remtime')[0];
		var src = goods.getElementsByTagName('img')[0].src;
		var dps = goods.getElementsByClassName('dps')[0].innerHTML;
		var price = goods.getElementsByClassName('price')[0].getElementsByTagName('em')[1].innerHTML;
		var timer = null;
		btn.onclick = function(){
			var val = txt.value;
			//设置目标时间
			var target = new Date(val);
			//console.log(date)
			timer = setInterval(function(){
				//获取当前时间
				var now = new Date();
				//剩余时间
				var shyTime = (target - now)/1000;
				if(shyTime>0){
					//时间还没到
					var shyT = Math.floor(shyTime/86400);
					var shyH = Math.floor(shyTime%86400/3600);
					var shyM = Math.floor(shyTime%3600/60);
					var shyS = Math.floor(shyTime%60);
					//倒计时显示时间
					remtime.innerHTML = '剩余'+two(shyT)+'天'+two(shyH)+'小时'+two(shyM)+'分钟'+two(shyS)+'秒';
				}else{
					//时间到了
					//关闭定时器
					clearInterval(timer);
					//抖动
					shake(goods,'left',function(){
						//下移
						move({
							obj:goods,
							attrs:{top:280},
							duration:500,
							callBack:function(){
								//下面生成一条列表
								ol.innerHTML += `<li><p>${dps}</p><span>${price}</span><div><img src="${src}" width="77" height="60" alt="" /></div></li>`;
								sum+= Number(price);
								result.innerHTML = sum;
							}
							
						})
					})
				}
			},1000)
			
		}
	}
	
	function two(n){
		return n<10?'0'+n:''+n;
    }
</script>